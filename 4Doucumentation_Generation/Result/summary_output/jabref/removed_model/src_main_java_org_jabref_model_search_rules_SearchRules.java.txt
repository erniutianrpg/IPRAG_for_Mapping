The `SearchRules` class is a factory that provides appropriate search rule implementations based on a query and search flags. It checks if the query is simple (non-punctuated) and returns a `ContainsBasedSearchRule`. For complex queries, it uses `GrammarBasedSearchRule` if valid; otherwise, it defaults to regex-based or contains-based search depending on the flags. The search flags control case sensitivity, regex, full-text search, and string retention.