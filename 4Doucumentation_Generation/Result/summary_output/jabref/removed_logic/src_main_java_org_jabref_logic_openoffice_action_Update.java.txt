This code provides functionality to update citation markers and bibliography sections in an OpenOffice document. The main `updateDocument` method synchronizes citation markers, rebuilds the bibliography if requested, and returns unresolved citation keys. It uses locking to prevent screen refreshes during updates. The `SyncOptions` class configures update behavior, while `synchronizeDocument` and `resyncDocument` methods provide higher-level interfaces for document synchronization, with the latter re-reading the document before updating. The code handles OpenOffice integration through UNO API calls.