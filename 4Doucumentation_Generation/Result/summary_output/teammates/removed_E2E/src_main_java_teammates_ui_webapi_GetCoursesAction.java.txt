This code handles API requests to retrieve course lists for instructors or students in a learning management system. For instructors, it returns courses filtered by status (active, archived, or soft-deleted) along with their privileges. For students, it returns only their enrolled courses with sensitive information hidden. The code includes authentication checks to ensure users can only access data appropriate to their role (instructor or student). The results are returned as JSON data.