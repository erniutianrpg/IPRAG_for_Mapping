This servlet handles OAuth2 callback authentication for a web application. It supports two authentication methods: Google OAuth2 and Firebase. For Google OAuth2, it validates the authorization code, retrieves user email, and checks session consistency. For Firebase, it verifies the ID token and extracts the email. In both cases, it creates a user info cookie if authentication succeeds, then redirects to a specified URL. If authentication fails, it invalidates the session. The servlet ensures secure session handling and proper error logging throughout the process.