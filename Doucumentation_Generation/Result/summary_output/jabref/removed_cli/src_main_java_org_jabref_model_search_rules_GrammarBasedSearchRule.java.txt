This code implements an advanced search rule for BibTeX entries using ANTLR grammar parsing. It supports complex search queries with logical operators (AND/OR), field comparisons (exact/contains/does not contain), and full-text PDF search capabilities. The search can be case-sensitive, regex-based, and includes special handling for keywords and entry types. The GrammarBasedSearchRule class validates queries, parses them into a syntax tree, and applies the search against BibTeX entries using a visitor pattern. It also integrates with a PDF search functionality when full-text search is enabled.