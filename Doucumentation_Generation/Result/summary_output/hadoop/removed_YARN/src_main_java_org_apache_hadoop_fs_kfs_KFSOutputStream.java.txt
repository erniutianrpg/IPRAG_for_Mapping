This code implements a Hadoop `FSDataOutputStream` for the Kosmos File System (KFS). It provides methods to write data to KFS files, supporting both appending to existing files and creating new ones with configurable replication. Key functionalities include writing bytes, flushing data to disk, tracking write position, and reporting progress. The class handles file operations through a `KfsOutputChannel` and ensures thread safety with synchronized close operations.