This code implements log aggregation for YARN applications in Hadoop. It collects container logs from local directories, aggregates them into a single file, and uploads them to a remote filesystem. The class handles log retention policies (keeping all, only AM containers, or failed containers), manages temporary files during upload, and cleans up local logs after aggregation. It runs asynchronously using a queue for pending containers and notifies when aggregation is complete. The implementation ensures secure file operations using user credentials.